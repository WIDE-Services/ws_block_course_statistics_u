/**
 * This file is part of Moodle - http://moodle.org/
 *
 * Moodle is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Moodle is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @package    block_course_statistics
 * @copyright  2023 onwards WIDE Services {@link https://www.wideservices.gr}
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ /*! Select for DataTables 1.2.0
 * 2015-2016 SpryMedia Ltd - datatables.net/license/mit
 */ !function(e){"function"==typeof define&&define.amd?define(["jquery","block_course_statistics/jquery.dataTables-lazy"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,l){return t||(t=window),l&&l.fn.dataTable||(l=require("datatables.net")(t,l).$),e(l,t,t.document)}:e(jQuery,window,document)}(function(e,t,l,s){"use strict";var c=e.fn.dataTable;function n(e,t,l){var s,c,n,a=function(t,l){if(t>l){var s=l;l=t,t=s}var c=!1;return e.columns(":visible").indexes().filter(function(e){return(e===t&&(c=!0),e===l)?(c=!1,!0):c})},o=function(t,l){var s=e.rows({search:"applied"}).indexes();if(s.indexOf(t)>s.indexOf(l)){var c=l;l=t,t=c}var n=!1;return s.filter(function(e){return(e===t&&(n=!0),e===l)?(n=!1,!0):n})};e.cells({selected:!0}).any()||l?(c=a(l.column,t.column),n=o(l.row,t.row)):(c=a(0,t.column),n=o(0,t.row)),s=e.cells(n,c).flatten(),e.cells(t,{selected:!0}).any()?e.cells(s).deselect():e.cells(s).select()}function a(t){var l=t.settings()[0]._select.selector;e(t.table().body()).off("mousedown.dtSelect",l).off("mouseup.dtSelect",l).off("click.dtSelect",l),e("body").off("click.dtSelect")}function o(l){var s=e(l.table().body()),c=l.settings()[0],n=c._select.selector;s.on("mousedown.dtSelect",n,function(e){(e.shiftKey||e.metaKey||e.ctrlKey)&&s.css("-moz-user-select","none").one("selectstart.dtSelect",n,function(){return!1})}).on("mouseup.dtSelect",n,function(){s.css("-moz-user-select","")}).on("click.dtSelect",n,function(s){var c,n=l.select.items();if(!(t.getSelection&&t.getSelection().toString())){var a=l.settings()[0];if(e(s.target).closest("div.dataTables_wrapper")[0]==l.table().container()){var o=l.cell(e(s.target).closest("td, th"));if(o.any()){var r=e.Event("user-select.dt");if(i(l,r,[n,o,s]),!r.isDefaultPrevented()){var u=o.index();"row"===n?f(s,l,a,"row",c=u.row):"column"===n?f(s,l,a,"column",c=o.index().column):"cell"===n&&f(s,l,a,"cell",c=o.index()),a._select_lastCell=u}}}}}),e("body").on("click.dtSelect",function(t){c._select.blurable&&!e(t.target).parents().filter(l.table().container()).length&&!e(t.target).parents("div.DTE").length&&d(c,!0)})}function i(t,l,s,c){(!c||t.flatten().length)&&("string"==typeof l&&(l+=".dt"),s.unshift(t),e(t.table().node()).triggerHandler(l,s))}function r(t){var l=t.settings()[0];if(l._select.info&&l.aanFeatures.i){var s=e('<span class="select-info"/>'),c=function(l,c){s.append(e('<span class="select-item"/>').append(t.i18n("select."+l+"s",{_:"%d "+l+"s selected",0:"",1:"1 "+l+" selected"},c)))};c("row",t.rows({selected:!0}).flatten().length),c("column",t.columns({selected:!0}).flatten().length),c("cell",t.cells({selected:!0}).flatten().length),e.each(l.aanFeatures.i,function(t,l){var c=(l=e(l)).children("span.select-info");c.length&&c.remove(),""!==s.text()&&l.append(s)})}}function u(t,l,s,c){var n=t[l+"s"]({search:"applied"}).indexes(),a=e.inArray(c,n),o=e.inArray(s,n);if(t[l+"s"]({selected:!0}).any()||-1!==a){if(a>o){var i=o;o=a,a=i}n.splice(o+1,n.length),n.splice(0,a)}else n.splice(e.inArray(s,n)+1,n.length);t[l](s,{selected:!0}).any()?(n.splice(e.inArray(s,n),1),t[l+"s"](n).deselect()):t[l+"s"](n).select()}function d(e,t){if(t||"single"===e._select.style){var l=new c.Api(e);l.rows({selected:!0}).deselect(),l.columns({selected:!0}).deselect(),l.cells({selected:!0}).deselect()}}function f(e,t,l,s,c){var a=t.select.style(),o=t[s](c,{selected:!0}).any();if("os"===a){if(e.ctrlKey||e.metaKey)t[s](c).select(!o);else if(e.shiftKey)"cell"===s?n(t,c,l._select_lastCell||null):u(t,s,c,l._select_lastCell?l._select_lastCell[s]:null);else{var i=t[s+"s"]({selected:!0});o&&1===i.flatten().length?t[s](c).deselect():(i.deselect(),t[s](c).select())}}else"multi+shift"==a&&e.shiftKey?"cell"===s?n(t,c,l._select_lastCell||null):u(t,s,c,l._select_lastCell?l._select_lastCell[s]:null):t[s](c).select(!o)}c.select={},c.select.version="1.2.0",c.select.init=function(t){var l=t.settings()[0],n=l.oInit.select,a=c.defaults.select,o=n===s?a:n,i="row",r="api",u=!1,d=!0,f="td, th",h="selected";l._select={},!0===o?r="os":"string"==typeof o?r=o:e.isPlainObject(o)&&(s!==o.blurable&&(u=o.blurable),s!==o.info&&(d=o.info),s!==o.items&&(i=o.items),s!==o.style&&(r=o.style),s!==o.selector&&(f=o.selector),s!==o.className&&(h=o.className)),t.select.selector(f),t.select.items(i),t.select.style(r),t.select.blurable(u),t.select.info(d),l._select.className=h,e.fn.dataTable.ext.order["select-checkbox"]=function(t,l){return this.api().column(l,{order:"index"}).nodes().map(function(l){return"row"===t._select.items?e(l).parent().hasClass(t._select.className):"cell"===t._select.items&&e(l).hasClass(t._select.className)})},e(t.table().node()).hasClass("selectable")&&t.select.style("os")},e.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],function(e,t){c.ext.selector[t.type].push(function(e,l,c){var n,a=l.selected,o=[];if(a===s)return c;for(var i=0,r=c.length;i<r;i++)n=e[t.prop][c[i]],(!0!==a||!0!==n._select_selected)&&(!1!==a||n._select_selected)||o.push(c[i]);return o})}),c.ext.selector.cell.push(function(e,t,l){var c,n=t.selected,a=[];if(n===s)return l;for(var o=0,i=l.length;o<i;o++)c=e.aoData[l[o].row],(!0!==n||!c._selected_cells||!0!==c._selected_cells[l[o].column])&&(!1!==n||c._selected_cells&&c._selected_cells[l[o].column])||a.push(l[o]);return a});var h=c.Api.register,m=c.Api.registerPlural;function $(e,t){return function(l){return l.i18n("buttons."+e,t)}}return h("select()",function(){return this.iterator("table",function(e){c.select.init(new c.Api(e))})}),h("select.blurable()",function(e){return e===s?this.context[0]._select.blurable:this.iterator("table",function(t){t._select.blurable=e})}),h("select.info()",function(e){return r===s?this.context[0]._select.info:this.iterator("table",function(t){t._select.info=e})}),h("select.items()",function(e){return e===s?this.context[0]._select.items:this.iterator("table",function(t){t._select.items=e,i(new c.Api(t),"selectItems",[e])})}),h("select.style()",function(t){return t===s?this.context[0]._select.style:this.iterator("table",function(l){if(l._select.style=t,!l._select_init){var n,u;n=l,u=new c.Api(n),n.aoRowCreatedCallback.push({fn:function(t,l,s){var c,a,o=n.aoData[s];for(o._select_selected&&e(t).addClass(n._select.className),c=0,a=n.aoColumns.length;c<a;c++)(n.aoColumns[c]._select_selected||o._selected_cells&&o._selected_cells[c])&&e(o.anCells[c]).addClass(n._select.className)},sName:"select-deferRender"}),u.on("preXhr.dt.dtSelect",function(){var e=u.rows({selected:!0}).ids(!0).filter(function(e){return e!==s}),t=u.cells({selected:!0}).eq(0).map(function(e){var t=u.row(e.row).id(!0);return t?{row:t,column:e.column}:s}).filter(function(e){return e!==s});u.one("draw.dt.dtSelect",function(){u.rows(e).select(),t.any()&&t.each(function(e){u.cells(e.row,e.column).select()})})}),u.on("draw.dtSelect.dt select.dtSelect.dt deselect.dtSelect.dt info.dt",function(){r(u)}),u.on("destroy.dtSelect",function(){a(u),u.off(".dtSelect")})}var d=new c.Api(l);a(d),"api"!==t&&o(d),i(new c.Api(l),"selectStyle",[t])})}),h("select.selector()",function(e){return e===s?this.context[0]._select.selector:this.iterator("table",function(t){a(new c.Api(t)),t._select.selector=e,"api"!==t._select.style&&o(new c.Api(t))})}),m("rows().select()","row().select()",function(t){var l=this;return!1===t?this.deselect():(this.iterator("row",function(t,l){d(t),t.aoData[l]._select_selected=!0,e(t.aoData[l].nTr).addClass(t._select.className)}),this.iterator("table",function(e,t){i(l,"select",["row",l[t]],!0)}),this)}),m("columns().select()","column().select()",function(t){var l=this;return!1===t?this.deselect():(this.iterator("column",function(t,l){d(t),t.aoColumns[l]._select_selected=!0;var s=new c.Api(t).column(l);e(s.header()).addClass(t._select.className),e(s.footer()).addClass(t._select.className),s.nodes().to$().addClass(t._select.className)}),this.iterator("table",function(e,t){i(l,"select",["column",l[t]],!0)}),this)}),m("cells().select()","cell().select()",function(t){var l=this;return!1===t?this.deselect():(this.iterator("cell",function(t,l,c){d(t);var n=t.aoData[l];s===n._selected_cells&&(n._selected_cells=[]),n._selected_cells[c]=!0,n.anCells&&e(n.anCells[c]).addClass(t._select.className)}),this.iterator("table",function(e,t){i(l,"select",["cell",l[t]],!0)}),this)}),m("rows().deselect()","row().deselect()",function(){var t=this;return this.iterator("row",function(t,l){t.aoData[l]._select_selected=!1,e(t.aoData[l].nTr).removeClass(t._select.className)}),this.iterator("table",function(e,l){i(t,"deselect",["row",t[l]],!0)}),this}),m("columns().deselect()","column().deselect()",function(){var t=this;return this.iterator("column",function(t,l){t.aoColumns[l]._select_selected=!1;var s=new c.Api(t),n=s.column(l);e(n.header()).removeClass(t._select.className),e(n.footer()).removeClass(t._select.className),s.cells(null,l).indexes().each(function(l){var s=t.aoData[l.row],c=s._selected_cells;!s.anCells||c&&c[l.column]||e(s.anCells[l.column]).removeClass(t._select.className)})}),this.iterator("table",function(e,l){i(t,"deselect",["column",t[l]],!0)}),this}),m("cells().deselect()","cell().deselect()",function(){var t=this;return this.iterator("cell",function(t,l,s){var c=t.aoData[l];c._selected_cells[s]=!1,c.anCells&&!t.aoColumns[s]._select_selected&&e(c.anCells[s]).removeClass(t._select.className)}),this.iterator("table",function(e,l){i(t,"deselect",["cell",t[l]],!0)}),this}),e.extend(c.ext.buttons,{selected:{text:$("selected","Selected"),className:"buttons-selected",init:function(e){var t=this;e.on("draw.dt.DT select.dt.DT deselect.dt.DT",function(){var e=t.rows({selected:!0}).any()||t.columns({selected:!0}).any()||t.cells({selected:!0}).any();t.enable(e)}),this.disable()}},selectedSingle:{text:$("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(e){var t=this;e.on("draw.dt.DT select.dt.DT deselect.dt.DT",function(){var l=e.rows({selected:!0}).flatten().length+e.columns({selected:!0}).flatten().length+e.cells({selected:!0}).flatten().length;t.enable(1===l)}),this.disable()}},selectAll:{text:$("selectAll","Select all"),className:"buttons-select-all",action:function(){this[this.select.items()+"s"]().select()}},selectNone:{text:$("selectNone","Deselect all"),className:"buttons-select-none",action:function(){d(this.settings()[0],!0)},init:function(e){var t=this;e.on("draw.dt.DT select.dt.DT deselect.dt.DT",function(){var l=e.rows({selected:!0}).flatten().length+e.columns({selected:!0}).flatten().length+e.cells({selected:!0}).flatten().length;t.enable(l>0)}),this.disable()}}}),e.each(["Row","Column","Cell"],function(e,t){var l=t.toLowerCase();c.ext.buttons["select"+t+"s"]={text:$("select"+t+"s","Select "+l+"s"),className:"buttons-select-"+l+"s",action:function(){this.select.items(l)},init:function(e){var t=this;e.on("selectItems.dt.DT",function(e,s,c){t.active(c===l)})}}}),e(l).on("preInit.dt.dtSelect",function(e,t){"dt"===e.namespace&&c.select.init(new c.Api(t))}),c.select});